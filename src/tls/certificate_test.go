package main

import (
	"crypto/x509"
	"os"
	"testing"
)

func TestParseCertificate(t *testing.T) {
	// const testECDSACertificate = "\x30\x82\x02\x00\x30\x82\x01\x62\x02\x09\x00\xb8\xbf\x2d\x47\xa0\xd2\xeb\xf4\x30\x09\x06\x07\x2a\x86\x48\xce\x3d\x04\x01\x30\x45\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x41\x55\x31\x13\x30\x11\x06\x03\x55\x04\x08\x13\x0a\x53\x6f\x6d\x65\x2d\x53\x74\x61\x74\x65\x31\x21\x30\x1f\x06\x03\x55\x04\x0a\x13\x18\x49\x6e\x74\x65\x72\x6e\x65\x74\x20\x57\x69\x64\x67\x69\x74\x73\x20\x50\x74\x79\x20\x4c\x74\x64\x30\x1e\x17\x0d\x31\x32\x31\x31\x32\x32\x31\x35\x30\x36\x33\x32\x5a\x17\x0d\x32\x32\x31\x31\x32\x30\x31\x35\x30\x36\x33\x32\x5a\x30\x45\x31\x0b\x30\x09\x06\x03\x55\x04\x06\x13\x02\x41\x55\x31\x13\x30\x11\x06\x03\x55\x04\x08\x13\x0a\x53\x6f\x6d\x65\x2d\x53\x74\x61\x74\x65\x31\x21\x30\x1f\x06\x03\x55\x04\x0a\x13\x18\x49\x6e\x74\x65\x72\x6e\x65\x74\x20\x57\x69\x64\x67\x69\x74\x73\x20\x50\x74\x79\x20\x4c\x74\x64\x30\x81\x9b\x30\x10\x06\x07\x2a\x86\x48\xce\x3d\x02\x01\x06\x05\x2b\x81\x04\x00\x23\x03\x81\x86\x00\x04\x00\xc4\xa1\xed\xbe\x98\xf9\x0b\x48\x73\x36\x7e\xc3\x16\x56\x11\x22\xf2\x3d\x53\xc3\x3b\x4d\x21\x3d\xcd\x6b\x75\xe6\xf6\xb0\xdc\x9a\xdf\x26\xc1\xbc\xb2\x87\xf0\x72\x32\x7c\xb3\x64\x2f\x1c\x90\xbc\xea\x68\x23\x10\x7e\xfe\xe3\x25\xc0\x48\x3a\x69\xe0\x28\x6d\xd3\x37\x00\xef\x04\x62\xdd\x0d\xa0\x9c\x70\x62\x83\xd8\x81\xd3\x64\x31\xaa\x9e\x97\x31\xbd\x96\xb0\x68\xc0\x9b\x23\xde\x76\x64\x3f\x1a\x5c\x7f\xe9\x12\x0e\x58\x58\xb6\x5f\x70\xdd\x9b\xd8\xea\xd5\xd7\xf5\xd5\xcc\xb9\xb6\x9f\x30\x66\x5b\x66\x9a\x20\xe2\x27\xe5\xbf\xfe\x3b\x30\x09\x06\x07\x2a\x86\x48\xce\x3d\x04\x01\x03\x81\x8c\x00\x30\x81\x88\x02\x42\x01\x88\xa2\x4f\xeb\xe2\x45\xc5\x48\x7d\x1b\xac\xf5\xed\x98\x9d\xae\x47\x70\xc0\x5e\x1b\xb6\x2f\xbd\xf1\xb6\x4d\xb7\x61\x40\xd3\x11\xa2\xce\xee\x0b\x7e\x92\x7e\xff\x76\x9d\xc3\x3b\x7e\xa5\x3f\xce\xfa\x10\xe2\x59\xec\x47\x2d\x7c\xac\xda\x4e\x97\x0e\x15\xa0\x6f\xd0\x02\x42\x01\x4d\xfc\xbe\x67\x13\x9c\x2d\x05\x0e\xbd\x3f\xa3\x8c\x25\xc1\x33\x13\x83\x0d\x94\x06\xbb\xd4\x37\x7a\xf6\xec\x7a\xc9\x86\x2e\xdd\xd7\x11\x69\x7f\x85\x7c\x56\xde\xfb\x31\x78\x2b\xe4\xc7\x78\x0d\xae\xcb\xbe\x9e\x4e\x36\x24\x31\x7b\x6a\x0f\x39\x95\x12\x07\x8f\x2a"
	// const testEd25519Certificate = "\x30\x82\x01\x2e\x30\x81\xe1\xa0\x03\x02\x01\x02\x02\x10\x0f\x43\x1c\x42\x57\x93\x94\x1d\xe9\x87\xe4\xf1\xad\x15\x00\x5d\x30\x05\x06\x03\x2b\x65\x70\x30\x12\x31\x10\x30\x0e\x06\x03\x55\x04\x0a\x13\x07\x41\x63\x6d\x65\x20\x43\x6f\x30\x1e\x17\x0d\x31\x39\x30\x35\x31\x36\x32\x31\x33\x38\x30\x31\x5a\x17\x0d\x32\x30\x30\x35\x31\x35\x32\x31\x33\x38\x30\x31\x5a\x30\x12\x31\x10\x30\x0e\x06\x03\x55\x04\x0a\x13\x07\x41\x63\x6d\x65\x20\x43\x6f\x30\x2a\x30\x05\x06\x03\x2b\x65\x70\x03\x21\x00\x3f\xe2\x15\x2e\xe6\xe3\xef\x3f\x4e\x85\x4a\x75\x77\xa3\x64\x9e\xed\xe0\xbf\x84\x2c\xcc\x92\x26\x8f\xfa\x6f\x34\x83\xaa\xec\x8f\xa3\x4d\x30\x4b\x30\x0e\x06\x03\x55\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa0\x30\x13\x06\x03\x55\x1d\x25\x04\x0c\x30\x0a\x06\x08\x2b\x06\x01\x05\x05\x07\x03\x01\x30\x0c\x06\x03\x55\x1d\x13\x01\x01\xff\x04\x02\x30\x00\x30\x16\x06\x03\x55\x1d\x11\x04\x0f\x30\x0d\x82\x0b\x65\x78\x61\x6d\x70\x6c\x65\x2e\x63\x6f\x6d\x30\x05\x06\x03\x2b\x65\x70\x03\x41\x00\x63\x44\xed\x9c\xc4\xbe\x53\x24\x53\x9f\xd2\x10\x8d\x9f\xe8\x21\x08\x90\x95\x39\xe5\x0d\xc1\x55\xff\x2c\x16\xb7\x1d\xfc\xab\x7d\x4d\xd4\xe0\x93\x13\xd0\xa9\x42\xe0\xb6\x6b\xfe\x5d\x67\x48\xd7\x9f\x50\xbc\x6c\xcd\x4b\x03\x83\x7c\xf2\x08\x58\xcd\xac\xcf\x0c"
	// der, err := os.ReadFile("../../tests/naruh.com.server.der")
	der, err := os.ReadFile("../../tests/github.der")
	if err != nil {
		t.Fatal(err)
	}
	cert, err := x509.ParseCertificate(der)
	if err != nil {
		t.Fatal(err)
	}
	t.Logf("cert=%+v", cert)
}
